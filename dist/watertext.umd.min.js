!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.watertext=e()}(this,function(){"use strict";var t={text:"",textWidth:void 0,textSize:12,textFont:"Sans-serif",textColor:"rgb(255, 255, 255)",backgroundColor:"rgba(0, 0, 0, 0.4)",position:"bottom",margin:10},e=function(t,e){var n=window.document.createElement("img");n.crossOrigin="Anonymous",n.onload=function(){var t=window.document.createElement("canvas");t.height=n.height,t.width=n.width,t.getContext("2d").drawImage(n,0,0),e(null,t)},n.onerror=function(t){return e(t)},n.src=t},n=function(t,e){var n=function(t){var e=window.document.createElement("canvas");e.width=t.textWidth,e.height=1.8*t.textSize;var n=e.getContext("2d");return n.fillStyle=t.backgroundColor,n.fillRect(0,0,e.width,e.height),n.fillStyle=t.textColor,n.font=t.textSize+"px "+t.textFont,n.textAlign="center",n.fillText(t.text,e.width/2,t.textSize+2),e}(e),i=t.getContext("2d"),o=t.width/2,r=t.height/2;i.translate(o,r);var a,h=-n.width/2;switch(e.position){case"left":i.rotate(-Math.PI/2),a=e.margin+(e.margin>=0?-o:o-n.height);break;case"right":i.rotate(Math.PI/2),a=e.margin+(e.margin>=0?-o:o-n.height);break;case"top":a=e.margin+(e.margin>=0?-r:r-n.height);break;case"bottom":a=-e.margin+(e.margin>=0?r-n.height:-r);break;default:throw new Error('Unknown "position" option: "'+e.position+'"')}return i.drawImage(n,h,a),t};return function(i,o){return new Promise(function(r,a){!function(i,o,r){e(i,function(e,i){if(e)r(e);else{var a={textWidth:["left","right"].includes(o.position)?i.height:i.width},h=Object.assign({},t,a,o),c=n(i,h).toDataURL();r(null,c)}})}(i,o,function(t,e){t?a(t):r(e)})})}});
