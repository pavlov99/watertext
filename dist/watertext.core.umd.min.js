!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.watertext=e()}(this,function(){"use strict";var t={text:"",textWidth:void 0,textSize:12,textFont:"Sans-serif",textColor:"rgb(255, 255, 255)",backgroundColor:"rgba(0, 0, 0, 0.4)",position:"bottom",margin:10},e=function(t,e){var i=window.document.createElement("img");i.crossOrigin="Anonymous",i.onload=function(){var t=window.document.createElement("canvas");t.height=i.height,t.width=i.width,t.getContext("2d").drawImage(i,0,0),e(null,t)},i.onerror=function(t){return e(t)},i.src=t},i=function(t,e){var i=function(t){var e=window.document.createElement("canvas");e.width=t.textWidth,e.height=1.8*t.textSize;var i=e.getContext("2d");return i.fillStyle=t.backgroundColor,i.fillRect(0,0,e.width,e.height),i.fillStyle=t.textColor,i.font=t.textSize+"px "+t.textFont,i.textAlign="center",i.fillText(t.text,e.width/2,t.textSize+2),e}(e),n=t.getContext("2d"),o=t.width/2,r=t.height/2;n.translate(o,r);var a,h=-i.width/2;switch(e.position){case"left":n.rotate(-Math.PI/2),a=e.margin+(e.margin>=0?-o:o-i.height);break;case"right":n.rotate(Math.PI/2),a=e.margin+(e.margin>=0?-o:o-i.height);break;case"top":a=e.margin+(e.margin>=0?-r:r-i.height);break;case"bottom":a=-e.margin+(e.margin>=0?r-i.height:-r);break;default:throw new Error('Unknown "position" option: "'+e.position+'"')}return n.drawImage(i,h,a),t};return function(n,o,r){e(n,function(e,n){if(e)r(e);else{var a={textWidth:["left","right"].includes(o.position)?n.height:n.width},h=Object.assign({},t,a,o),d=i(n,h).toDataURL();r(null,d)}})}});
